# ğŸ”„ è¿ç§»æŒ‡å—

æœ¬æ–‡æ¡£å¸®åŠ©ä½ å¿«é€Ÿè¿ç§»åˆ°æ–°çš„é…ç½®ç®¡ç†ç³»ç»Ÿã€‚

---

## âš¡ å¿«é€Ÿè¿ç§»ï¼ˆ5åˆ†é’Ÿï¼‰

### æ­¥éª¤ 1ï¼šåˆ›å»ºé…ç½®æ–‡ä»¶

```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp .env.example .env
```

### æ­¥éª¤ 2ï¼šå¡«å…¥ Token

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„ Tushare Tokenï¼š

```bash
TUSHARE_TOKEN=your_actual_token_here
```

### æ­¥éª¤ 3ï¼šå®‰è£…æ–°ä¾èµ–

```bash
pip install python-dotenv
```

### æ­¥éª¤ 4ï¼šé‡å¯åº”ç”¨

```bash
streamlit run streamlit_app.py
```

âœ… å®Œæˆï¼ç³»ç»Ÿç°åœ¨ä½¿ç”¨ç¯å¢ƒå˜é‡é…ç½®ã€‚

---

## ğŸ“‹ è¯¦ç»†è¿ç§»æ­¥éª¤

### 1. å¤‡ä»½ç°æœ‰é…ç½®

å¦‚æœä½ ä¹‹å‰ä¿®æ”¹è¿‡ä»£ç ä¸­çš„ Tokenï¼Œå…ˆè®°å½•ä¸‹æ¥ï¼š

```bash
# æŸ¥æ‰¾æ‰€æœ‰ Token
grep -r "TUSHARE_TOKEN" aitrader_core/
```

### 2. æ›´æ–°ä»£ç 

æ‹‰å–æœ€æ–°ä»£ç ï¼š

```bash
git pull origin main
```

æˆ–è€…æ‰‹åŠ¨æ›´æ–°ä»¥ä¸‹æ–‡ä»¶ï¼š
- `aitrader_core/datafeed/tushare_loader.py`
- `aitrader_core/update_daily_stock_data.py`
- `aitrader_core/download_all_stock_data.py`
- `aitrader_core/update_with_tushare_direct.py`

### 3. é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# åŸºæœ¬é…ç½®
TUSHARE_TOKEN=your_token_here

# å¯é€‰é…ç½®
STOCK_DATA_DIR=/path/to/your/data
LOG_LEVEL=INFO
CACHE_TTL_MINUTES=30
```

### 4. éªŒè¯é…ç½®

è¿è¡Œé…ç½®æ£€æŸ¥ï¼š

```bash
python -c "from modules.config_manager import Config; Config.print_config()"
```

é¢„æœŸè¾“å‡ºï¼š
```
============================================================
å½“å‰é…ç½®ä¿¡æ¯
============================================================
é¡¹ç›®æ ¹ç›®å½•: /path/to/project
æ•°æ®ç›®å½•: /path/to/project/data
ç¼“å­˜ç›®å½•: /path/to/project/data_cache
æ—¥å¿—ç›®å½•: /path/to/project/logs
è‚¡ç¥¨æ•°æ®ç›®å½•: /path/to/project/data/stock_data
Tushare Token: å·²é…ç½®
Webhook URL: æœªé…ç½®
æ—¥å¿—çº§åˆ«: INFO
ç¼“å­˜TTL: 30åˆ†é’Ÿ
è¯·æ±‚é™æµ: 15æ¬¡/åˆ†é’Ÿ
è°ƒè¯•æ¨¡å¼: False
============================================================
```

### 5. æµ‹è¯•åŠŸèƒ½

å¯åŠ¨åº”ç”¨å¹¶æµ‹è¯•ï¼š

```bash
streamlit run streamlit_app.py
```

æµ‹è¯•ä»¥ä¸‹åŠŸèƒ½ï¼š
- [ ] Tushare æ•°æ®æºå¯ç”¨
- [ ] æ•°æ®æ›´æ–°æ­£å¸¸
- [ ] ç­–ç•¥å›æµ‹æ­£å¸¸
- [ ] æ—¥å¿—è®°å½•æ­£å¸¸

---

## ğŸ”§ å¸¸è§è¿ç§»é—®é¢˜

### é—®é¢˜ 1ï¼šæç¤º Token æœªé…ç½®

**ç—‡çŠ¶**ï¼š
```
âŒ TUSHARE_TOKEN ç¯å¢ƒå˜é‡æœªè®¾ç½®
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤ `.env` æ–‡ä»¶åœ¨é¡¹ç›®æ ¹ç›®å½•
2. ç¡®è®¤æ–‡ä»¶å†…å®¹æ ¼å¼æ­£ç¡®ï¼ˆæ— ç©ºæ ¼ã€æ— å¼•å·ï¼‰
3. é‡å¯åº”ç”¨

### é—®é¢˜ 2ï¼šæ‰¾ä¸åˆ° python-dotenv

**ç—‡çŠ¶**ï¼š
```
ModuleNotFoundError: No module named 'dotenv'
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
pip install python-dotenv
```

### é—®é¢˜ 3ï¼šé…ç½®ä¸ç”Ÿæ•ˆ

**ç—‡çŠ¶**ï¼šé…ç½®ä¿®æ”¹åæ²¡æœ‰å˜åŒ–

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤ä¿®æ”¹çš„æ˜¯ `.env` è€Œä¸æ˜¯ `.env.example`
2. é‡å¯åº”ç”¨ï¼ˆStreamlit éœ€è¦é‡å¯æ‰èƒ½åŠ è½½æ–°é…ç½®ï¼‰
3. æ£€æŸ¥æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯

### é—®é¢˜ 4ï¼šDocker ç¯å¢ƒé…ç½®

**ç—‡çŠ¶**ï¼šDocker å®¹å™¨ä¸­æ— æ³•è¯»å– `.env`

**è§£å†³æ–¹æ¡ˆ**ï¼š

æ–¹æ³• 1ï¼šä½¿ç”¨ docker-compose
```yaml
# docker-compose.yml
services:
  app:
    env_file:
      - .env
```

æ–¹æ³• 2ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡
```bash
docker run -e TUSHARE_TOKEN=your_token app
```

### é—®é¢˜ 5ï¼šStreamlit Cloud éƒ¨ç½²

**ç—‡çŠ¶**ï¼šäº‘ç«¯éƒ¨ç½²åæç¤º Token æœªé…ç½®

**è§£å†³æ–¹æ¡ˆ**ï¼š

åœ¨ Streamlit Cloud è®¾ç½®ä¸­æ·»åŠ  Secretsï¼š

1. è¿›å…¥åº”ç”¨è®¾ç½®
2. æ‰¾åˆ° "Secrets" é€‰é¡¹
3. æ·»åŠ ï¼š
```toml
TUSHARE_TOKEN = "your_token_here"
```

---

## ğŸ¯ è¿ç§»æ£€æŸ¥æ¸…å•

### ä»£ç æ›´æ–°
- [ ] æ‹‰å–æœ€æ–°ä»£ç 
- [ ] æ£€æŸ¥æ‰€æœ‰æ–‡ä»¶å·²æ›´æ–°
- [ ] åˆ é™¤æ—§çš„ç¡¬ç¼–ç  Token

### é…ç½®æ–‡ä»¶
- [ ] åˆ›å»º `.env` æ–‡ä»¶
- [ ] å¡«å…¥ Tushare Token
- [ ] é…ç½®å…¶ä»–å¯é€‰é¡¹
- [ ] ç¡®è®¤ `.env` åœ¨ `.gitignore` ä¸­

### ä¾èµ–å®‰è£…
- [ ] å®‰è£… python-dotenv
- [ ] æ›´æ–°å…¶ä»–ä¾èµ–ï¼ˆå¦‚æœ‰ï¼‰

### åŠŸèƒ½æµ‹è¯•
- [ ] é…ç½®éªŒè¯é€šè¿‡
- [ ] æ•°æ®æºæ­£å¸¸å·¥ä½œ
- [ ] æ—¥å¿—æ­£å¸¸è®°å½•
- [ ] ç¼“å­˜æ­£å¸¸å·¥ä½œ

### æ–‡æ¡£é˜…è¯»
- [ ] é˜…è¯» [é…ç½®æŒ‡å—.md](./é…ç½®æŒ‡å—.md)
- [ ] é˜…è¯» [æ¶æ„ä¼˜åŒ–è¯´æ˜.md](./æ¶æ„ä¼˜åŒ–è¯´æ˜.md)
- [ ] äº†è§£æ–°çš„é”™è¯¯å¤„ç†æœºåˆ¶
- [ ] äº†è§£æ–°çš„æ—¥å¿—ç³»ç»Ÿ

---

## ğŸ’¡ è¿ç§»åçš„ä¼˜åŠ¿

### 1. å®‰å…¨æ€§æå‡
- âœ… Token ä¸å†æš´éœ²åœ¨ä»£ç ä¸­
- âœ… ä¸ä¼šæ„å¤–æäº¤åˆ° Git
- âœ… æ˜“äºæ›´æ¢å’Œç®¡ç†

### 2. é…ç½®æ›´çµæ´»
- âœ… æ”¯æŒå¤šç¯å¢ƒé…ç½®
- âœ… æ˜“äºéƒ¨ç½²åˆ°ä¸åŒå¹³å°
- âœ… å›¢é˜Ÿåä½œæ›´æ–¹ä¾¿

### 3. ä»£ç æ›´æ¸…æ™°
- âœ… é…ç½®é›†ä¸­ç®¡ç†
- âœ… ä»£ç é€»è¾‘æ›´æ¸…æ™°
- âœ… æ˜“äºç»´æŠ¤å’Œæ‰©å±•

### 4. é”™è¯¯å¤„ç†æ›´å¥½
- âœ… ç»Ÿä¸€çš„é”™è¯¯æç¤º
- âœ… è¯¦ç»†çš„æ—¥å¿—è®°å½•
- âœ… ä¾¿äºé—®é¢˜æ’æŸ¥

---

## ğŸš€ ä½¿ç”¨æ–°åŠŸèƒ½

### 1. ä½¿ç”¨é…ç½®ç®¡ç†å™¨

```python
from modules.config_manager import Config

# è·å–é…ç½®
token = Config.get_tushare_token()
data_dir = Config.STOCK_DATA_DIR

# æ‰“å°é…ç½®ï¼ˆè°ƒè¯•ç”¨ï¼‰
Config.print_config()
```

### 2. ä½¿ç”¨é”™è¯¯å¤„ç†

```python
from modules.error_handler import handle_errors

@handle_errors("æ•°æ®åŠ è½½å¤±è´¥", return_value=None)
def load_data(symbol):
    # ä½ çš„ä»£ç 
    pass
```

### 3. ä½¿ç”¨æ—¥å¿—ç³»ç»Ÿ

```python
from modules.logger_config import logger

logger.info("å¼€å§‹å¤„ç†æ•°æ®")
logger.warning("æ•°æ®å¯èƒ½ä¸å®Œæ•´")
logger.error("å¤„ç†å¤±è´¥")
```

---

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœè¿ç§»è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. **æŸ¥çœ‹æ—¥å¿—**ï¼š`logs/error_*.log`
2. **è¿è¡Œè¯Šæ–­**ï¼š`python -m modules.config_manager`
3. **æŸ¥çœ‹æ–‡æ¡£**ï¼š[é…ç½®æŒ‡å—.md](./é…ç½®æŒ‡å—.md)
4. **æäº¤ Issue**ï¼š[GitHub Issues](https://github.com/Ecustkiller/aytradingstragegy/issues)

---

## ğŸ”„ å›æ»šæ–¹æ¡ˆ

å¦‚æœéœ€è¦å›æ»šåˆ°æ—§ç‰ˆæœ¬ï¼š

```bash
# 1. å›é€€ä»£ç 
git checkout <old_commit_hash>

# 2. æ¢å¤æ—§çš„ Token é…ç½®
# ç¼–è¾‘ç›¸å…³æ–‡ä»¶ï¼Œå¡«å…¥ Token

# 3. é‡å¯åº”ç”¨
streamlit run streamlit_app.py
```

**æ³¨æ„**ï¼šä¸å»ºè®®å›æ»šï¼Œæ–°ç‰ˆæœ¬æ›´å®‰å…¨ã€æ›´æ˜“ç»´æŠ¤ã€‚

---

**æœ€åæ›´æ–°**ï¼š2025-01-13
