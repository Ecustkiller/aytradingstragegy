# ğŸš€ æ–°æ¶æ„å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ“– æ¦‚è¿°

æœ¬æŒ‡å—å¸®åŠ©ä½ å¿«é€Ÿä¸Šæ‰‹ä½¿ç”¨æ–°çš„æ•°æ®æºæ¶æ„ã€‚æ–°æ¶æ„æä¾›äº†ç»Ÿä¸€çš„æ¥å£ï¼Œè®©ä½ å¯ä»¥è½»æ¾åˆ‡æ¢ä¸åŒçš„æ•°æ®æºã€‚

---

## âš¡ 5åˆ†é’Ÿå¿«é€Ÿå¼€å§‹

### 1. æ£€æŸ¥é…ç½®

ç¡®ä¿ `.env` æ–‡ä»¶å·²é…ç½®ï¼š

```bash
# æŸ¥çœ‹é…ç½®çŠ¶æ€
python3 -c "from modules.config_manager import Config; Config.print_config()"
```

### 2. æŸ¥çœ‹å¯ç”¨æ•°æ®æº

```python
from aitrader_core.datafeed.datasource_factory import DataSourceFactory

# åˆ—å‡ºæ‰€æœ‰å¯ç”¨æ•°æ®æº
sources = DataSourceFactory.list_available_sources()
print(f"å¯ç”¨æ•°æ®æº: {sources}")
# è¾“å‡º: ['Tushare', 'AKShare', 'CSV', 'Ashare']
```

### 3. è·å–æ•°æ®

```python
from aitrader_core.datafeed.datasource_factory import DataSourceFactory

# è·å–å•åªè‚¡ç¥¨æ•°æ®
df = DataSourceFactory.get_data(
    symbols=['600519.SH'],
    start_date='2023-01-01',
    end_date='2023-12-31',
    source_type='Tushare'
)

print(df.head())
```

### 4. æ‰¹é‡è·å–æ•°æ®

```python
# è·å–å¤šåªè‚¡ç¥¨æ•°æ®
df = DataSourceFactory.get_data(
    symbols=['600519.SH', '000001.SZ', '510300.SH'],
    start_date='2023-01-01',
    end_date='2023-12-31',
    source_type='Tushare'
)

print(f"è·å–äº† {len(df)} æ¡æ•°æ®")
```

---

## ğŸ’¡ å¸¸ç”¨åœºæ™¯

### åœºæ™¯1ï¼šå†å²å›æµ‹

```python
from aitrader_core.datafeed.datasource_factory import DataSourceFactory

# ä½¿ç”¨CSVæ•°æ®æºï¼ˆæœ€å¿«ï¼‰
df = DataSourceFactory.get_data(
    symbols=['600519.SH', '000001.SZ'],
    start_date='2020-01-01',
    end_date='2023-12-31',
    source_type='CSV'
)

# è¿›è¡Œå›æµ‹
# ...
```

### åœºæ™¯2ï¼šå®æ—¶ç›‘æ§

```python
from aitrader_core.datafeed.datasource_factory import DataSourceFactory
from datetime import datetime, timedelta

# ä½¿ç”¨Ashareæ•°æ®æºï¼ˆå®æ—¶æ€§å¥½ï¼‰
end_date = datetime.now().strftime('%Y-%m-%d')
start_date = (datetime.now() - timedelta(days=30)).strftime('%Y-%m-%d')

df = DataSourceFactory.get_data(
    symbols=['600519.SH'],
    start_date=start_date,
    end_date=end_date,
    source_type='Ashare'
)

print(f"æœ€æ–°ä»·æ ¼: {df.iloc[-1]['close']}")
```

### åœºæ™¯3ï¼šç²¾ç¡®ç ”ç©¶

```python
from aitrader_core.datafeed.datasource_factory import DataSourceFactory

# ä½¿ç”¨Tushareæ•°æ®æºï¼ˆè´¨é‡æœ€é«˜ï¼‰
df = DataSourceFactory.get_data(
    symbols=['600519.SH'],
    start_date='2023-01-01',
    end_date='2023-12-31',
    source_type='Tushare'
)

# è¿›è¡Œåˆ†æ
# ...
```

### åœºæ™¯4ï¼šå¿«é€ŸéªŒè¯

```python
from aitrader_core.datafeed.datasource_factory import DataSourceFactory

# ä½¿ç”¨AKShareæ•°æ®æºï¼ˆå…è´¹ä¾¿æ·ï¼‰
df = DataSourceFactory.get_data(
    symbols=['600519.SH'],
    start_date='2023-01-01',
    end_date='2023-12-31',
    source_type='AKShare'
)

# å¿«é€ŸéªŒè¯æƒ³æ³•
# ...
```

---

## ğŸ”„ æ•°æ®æºåˆ‡æ¢

### æ–¹æ³•1ï¼šç›´æ¥åˆ‡æ¢

```python
# åªéœ€ä¿®æ”¹ source_type å‚æ•°
for source in ['Tushare', 'AKShare', 'CSV', 'Ashare']:
    df = DataSourceFactory.get_data(
        symbols=['600519.SH'],
        start_date='2023-01-01',
        end_date='2023-12-31',
        source_type=source
    )
    print(f"{source}: {len(df)} æ¡æ•°æ®")
```

### æ–¹æ³•2ï¼šè‡ªåŠ¨é™çº§

```python
# ä¼˜å…ˆä½¿ç”¨Tushareï¼Œä¸å¯ç”¨æ—¶è‡ªåŠ¨åˆ‡æ¢
preferred_sources = ['Tushare', 'CSV', 'AKShare', 'Ashare']

df = None
for source in preferred_sources:
    if source in DataSourceFactory.list_available_sources():
        try:
            df = DataSourceFactory.get_data(
                symbols=['600519.SH'],
                start_date='2023-01-01',
                end_date='2023-12-31',
                source_type=source
            )
            if not df.empty:
                print(f"âœ… ä½¿ç”¨ {source} æ•°æ®æº")
                break
        except Exception as e:
            print(f"âŒ {source} å¤±è´¥: {e}")
            continue

if df is None or df.empty:
    print("âŒ æ‰€æœ‰æ•°æ®æºéƒ½ä¸å¯ç”¨")
```

---

## ğŸ“Š æ•°æ®æ ¼å¼

æ‰€æœ‰æ•°æ®æºè¿”å›çš„DataFrameéƒ½åŒ…å«ç›¸åŒçš„åˆ—ï¼š

```python
df.columns
# ['date', 'open', 'high', 'low', 'close', 'volume', 'symbol']
```

ç¤ºä¾‹æ•°æ®ï¼š

```
         date    open    high     low   close      volume     symbol
0  2023-01-03  1850.0  1880.0  1845.0  1875.0  12345678.0  600519.SH
1  2023-01-04  1875.0  1890.0  1870.0  1885.0  10234567.0  600519.SH
2  2023-01-05  1885.0  1900.0  1880.0  1895.0  11345678.0  600519.SH
```

---

## ğŸ› ï¸ é«˜çº§ç”¨æ³•

### 1. ä½¿ç”¨ç‰¹å®šæ•°æ®æºå®ä¾‹

```python
from aitrader_core.datafeed.tushare_loader import TushareDataSource

# åˆ›å»ºæ•°æ®æºå®ä¾‹
datasource = TushareDataSource()

# æ£€æŸ¥å¯ç”¨æ€§
if datasource.is_available():
    # è·å–è‚¡ç¥¨æ•°æ®
    df = datasource.get_stock_data('600519.SH', '2023-01-01', '2023-12-31')
    
    # è·å–æŒ‡æ•°æ•°æ®
    df = datasource.get_index_data('000001.SH', '2023-01-01', '2023-12-31')
    
    # è·å–åŸºé‡‘æ•°æ®
    df = datasource.get_fund_data('510300.SH', '2023-01-01', '2023-12-31')
    
    # è‡ªåŠ¨è¯†åˆ«ç±»å‹
    df = datasource.get_data_auto('600519.SH', '2023-01-01', '2023-12-31')
```

### 2. æ‰¹é‡è·å–å¤šä¸ªè¯åˆ¸

```python
from aitrader_core.datafeed.tushare_loader import TushareDataSource

datasource = TushareDataSource()

# ä¸€æ¬¡è·å–å¤šä¸ªè¯åˆ¸çš„æ•°æ®
df = datasource.get_multiple_data(
    symbols=['600519.SH', '000001.SZ', '510300.SH'],
    start_date='2023-01-01',
    end_date='2023-12-31'
)

# æ•°æ®è‡ªåŠ¨åˆå¹¶å’Œæ’åº
print(df.groupby('symbol').size())
```

### 3. è‡ªå®šä¹‰æ—¥æœŸæ ¼å¼

```python
# æ”¯æŒå¤šç§æ—¥æœŸæ ¼å¼
df = DataSourceFactory.get_data(
    symbols=['600519.SH'],
    start_date='2023-01-01',    # YYYY-MM-DD
    # start_date='20230101',    # YYYYMMDD
    # start_date='2023/01/01',  # YYYY/MM/DD
    end_date='2023-12-31',
    source_type='Tushare'
)
```

---

## ğŸ” è°ƒè¯•æŠ€å·§

### 1. æŸ¥çœ‹æ•°æ®æºè¯¦ç»†ä¿¡æ¯

```python
from aitrader_core.datafeed.datasource_factory import DataSourceFactory

info = DataSourceFactory.get_source_info()
for name, details in info.items():
    print(f"{name}:")
    print(f"  å¯ç”¨: {details['available']}")
    print(f"  ç±»å‹: {details['type']}")
```

### 2. å¯ç”¨è°ƒè¯•æ—¥å¿—

```python
from loguru import logger
import sys

# è®¾ç½®æ—¥å¿—çº§åˆ«ä¸ºDEBUG
logger.remove()
logger.add(sys.stderr, level="DEBUG")

# ç°åœ¨å¯ä»¥çœ‹åˆ°è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯
df = DataSourceFactory.get_data(...)
```

### 3. æ£€æŸ¥æ•°æ®è´¨é‡

```python
# æ£€æŸ¥æ•°æ®å®Œæ•´æ€§
print(f"æ•°æ®æ¡æ•°: {len(df)}")
print(f"ç¼ºå¤±å€¼: {df.isnull().sum()}")
print(f"æ—¥æœŸèŒƒå›´: {df['date'].min()} åˆ° {df['date'].max()}")
print(f"è¯åˆ¸ä»£ç : {df['symbol'].unique()}")
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: æ•°æ®æºä¸å¯ç”¨æ€ä¹ˆåŠï¼Ÿ

```python
# æ£€æŸ¥å¯ç”¨æ•°æ®æº
available = DataSourceFactory.list_available_sources()

if 'Tushare' not in available:
    print("Tushareä¸å¯ç”¨ï¼Œè¯·æ£€æŸ¥Tokené…ç½®")
    # ä½¿ç”¨å¤‡ç”¨æ•°æ®æº
    df = DataSourceFactory.get_data(..., source_type='CSV')
```

### Q2: å¦‚ä½•å¤„ç†ç©ºæ•°æ®ï¼Ÿ

```python
df = DataSourceFactory.get_data(...)

if df.empty:
    print("æœªè·å–åˆ°æ•°æ®ï¼Œå¯èƒ½åŸå› ï¼š")
    print("1. è¯åˆ¸ä»£ç é”™è¯¯")
    print("2. æ—¥æœŸèŒƒå›´æ— äº¤æ˜“æ•°æ®")
    print("3. æ•°æ®æºä¸å¯ç”¨")
else:
    print(f"æˆåŠŸè·å– {len(df)} æ¡æ•°æ®")
```

### Q3: å¦‚ä½•æé«˜è·å–é€Ÿåº¦ï¼Ÿ

```python
# 1. ä½¿ç”¨CSVæ•°æ®æºï¼ˆæœ€å¿«ï¼‰
df = DataSourceFactory.get_data(..., source_type='CSV')

# 2. æ‰¹é‡è·å–è€Œéå•ç‹¬è·å–
# æ¨è
df = DataSourceFactory.get_data(
    symbols=['600519.SH', '000001.SZ', '510300.SH'],
    ...
)

# ä¸æ¨è
for symbol in symbols:
    df = DataSourceFactory.get_data([symbol], ...)

# 3. ç¼©å°æ—¥æœŸèŒƒå›´
df = DataSourceFactory.get_data(
    symbols=['600519.SH'],
    start_date='2023-01-01',  # åªè·å–éœ€è¦çš„æ—¥æœŸèŒƒå›´
    end_date='2023-12-31',
    ...
)
```

---

## ğŸ“š æ›´å¤šèµ„æº

- [æ•°æ®æºæ¶æ„ä¼˜åŒ–è¯´æ˜.md](./æ•°æ®æºæ¶æ„ä¼˜åŒ–è¯´æ˜.md) - è¯¦ç»†çš„æ¶æ„è¯´æ˜
- [é…ç½®æŒ‡å—.md](./é…ç½®æŒ‡å—.md) - é…ç½®è¯¦ç»†è¯´æ˜
- [æ¶æ„ä¼˜åŒ–å®Œæˆæ€»ç»“.md](./æ¶æ„ä¼˜åŒ–å®Œæˆæ€»ç»“.md) - ä¼˜åŒ–å·¥ä½œæ€»ç»“
- [æ•°æ®æºä½¿ç”¨è¯´æ˜.md](./æ•°æ®æºä½¿ç”¨è¯´æ˜.md) - å„æ•°æ®æºç‰¹ç‚¹å¯¹æ¯”

---

## ğŸ¯ ä¸‹ä¸€æ­¥

1. **ç†Ÿæ‚‰åŸºæœ¬ç”¨æ³•**: å°è¯•ä¸Šé¢çš„ç¤ºä¾‹ä»£ç 
2. **é€‰æ‹©åˆé€‚çš„æ•°æ®æº**: æ ¹æ®åœºæ™¯é€‰æ‹©æœ€é€‚åˆçš„æ•°æ®æº
3. **é›†æˆåˆ°é¡¹ç›®**: åœ¨ä½ çš„å›æµ‹æˆ–åˆ†æä»£ç ä¸­ä½¿ç”¨æ–°æ¶æ„
4. **æ¢ç´¢é«˜çº§åŠŸèƒ½**: å°è¯•æ‰¹é‡è·å–ã€è‡ªåŠ¨é™çº§ç­‰é«˜çº§åŠŸèƒ½

---

## ğŸ’¬ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹æ–‡æ¡£ä¸­çš„å¸¸è§é—®é¢˜éƒ¨åˆ†
2. æ£€æŸ¥æ—¥å¿—è¾“å‡º
3. æäº¤Issueæè¿°é—®é¢˜

---

**ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰

---

**æ›´æ–°æ—¶é—´**: 2025-11-13  
**ç‰ˆæœ¬**: v2.0
